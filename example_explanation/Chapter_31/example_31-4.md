### 回答

- ギブスサンプリング
    
    **「変数を1つずつ更新する」方式のサンプリング**
    
    ギブスサンプリングは、複数の変数 $x_1, x_2, ..., x_n$  を持つ確率分布からサンプリングする方法です。特に、**条件付き分布が簡単に扱える場合に便利**。
    
    ### **手順（2変数の場合）**
    
    1. **初期値$(x_1^{(0)}, x_2^{(0)})$を決める。**
    2. **1つの変数を条件付き分布からサンプリングする。**
        - 例えば、$x_1$を$p(x_1 | x_2)$ からサンプリング。
    3. **もう1つの変数を更新する。**
        - $x_2$  を $p(x_2 | x_1)$からサンプリング。
    4. **繰り返す。**
        - $(x_1, x_2)$を何度も更新し、十分にサンプルを集める。
    
    ### **ポイント**
    
    - **1つの変数ずつ確実に更新できる**ため、条件付き分布が簡単に計算できる場合に便利
    - 例えば、ベイズ統計のように「条件付き分布が解析的に求まる」場合に向いている
    - ただし、変数間の依存が強い場合、収束が遅くなることがある

交互にサンプリングするので条件付き確率を求める

$\mu = (0, 2)^T$, $\Sigma=
\begin{bmatrix} 
1 & 0.5 \\ 
0.5 & 1 
\end{bmatrix}$より

$E[X]=0,\ V[X]= 1,\ E[Y] = 2,\ V[Y] = 1$

相関係数$p=\frac{Cov(x,y)}{\sqrt{1\cdot 1}}=0.5/1 =0.5$

- (1)
    
    条件付き期待値の公式：$E[x|Y=y] = E[X] + p(\sigma_x/\sigma_y)(y^{(t)} - E[Y])$より
    
    $$
    E[X|Y=y]= 0 + 0.5(1/1)(y^{(t)}-2)\\
    = 0.5(y^{(t)}-2)\\
    = \frac{y^{(t)}}{2}-1
    $$
    
    条件付き分散の公式：$V[X|Y=y] = \sigma_x^2 (1-p^2)$より
    
    $$
    V[X|Y=y]= 1(1-(0.5)^2)\\
    = 1-0.25 = 0.75
    $$
    
    よって$N(\frac{y^{(t)}}{2}-1, 0.75)$
    
- (2)$x^{t+1}$を所与とした時、
    
    $$
    E[Y|X=x] = 2+0.5(1/1)(x^{(t+1)} - 0)\\
    = 2+\frac{1}{2}x^{(t+1)}
    $$
    

$$
V[Y|X=x] = 1(1-(0.5)^2)\\
= 0.75
$$

よって$N(2+\frac{1}{2}x^{(t+1)}, 0.75)$