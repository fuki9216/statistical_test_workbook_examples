### 回答

ベータ分布$Be(2,2)$に従う乱数を採択棄却法で生成する

- 確率密度関数
    
    $$
    f(x) = 6x(1-x), 0<x<1
    $$
    
- 正規化されていない関数$l(x)$
    
    $l(x) = x(1-x)$
    
- 正規化定数（=面積）
    
    $c=\int^1_0 x(1-x) dx = 1/6$
    
- 提案分布$g(x)$とスケール係数$M_1, M_2$
    
    提案分布：一様分布$g(x) = 1$
    
    - スケール係数
        
        $M_1=1$
        
        $M_2 =1/4$
        
- 手順
    1. 一様乱数$U(0,1)$から生成した$x$を取得
    2. $r= x(1-x)/M_i$として$x$とは独立な一様乱数$U(0,1)$から生成した$u$と比較
    3. $u\leq r$なら$x$を出力（採択）、小さければ何も出さない（棄却）
    4. これを繰り返してサンプリングすると$x$は確率密度$x(1-x)$に収束する
    
- $M_i$効率
    
    $x(1-x)$の極値から最大値を取得する
    
    微分する
    
    $$
    \frac{\partial}{\partial x} x(1-x)\\
    = 1(1-x) + x(-1)\\
    1-2x
    $$
    
    これを0として
    
    $$
    1-2x = 0\\
    x = 1/2
    $$
    
    $x=1/2$を代入して
    
    $$
    1/2(1-1/2) = 1/4
    $$
    
    最大値は$1/4$ となる
    
    採択率が高いほうが効率が良い=閾値が近いほうが良く、それは面積比で決まる
    
    $l(x)$の面積は問題より$1/6$なので
    
    $M_1$の面積比：$\frac{1}{6\cdot 1} =1/6$
    
    $M_2$の面積比：$\frac{1}{6}\cdot \frac{4}{1} = 2/3$
    
    $M_2$が4倍効率が良い