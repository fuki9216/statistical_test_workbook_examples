## 統計検定準1級(Statistical Test Pre-1st grade)
## 24章 例題1
### 回答

- (1)
    
    (b)最近隣法：近いものから結合していく
    
    (a)再遠燐法：距離が小さいもの同士でクラスタを作成し、作成した中から大きい数値をクラスタ距離
    
- **最遠燐法の具体例**
    
    **例：6×6 の距離行列**
    
    ```
       A  B  C  D  E  F
    A  0  2  6 10  9 12
    B  2  0  4  8  7 10
    C  6  4  0  7  6  9
    D 10  8  7  0  5  6
    E  9  7  6  5  0  3
    F 12 10  9  6  3  0
    
    ```
    
    1. **最も近いクラスタを探す**
        - $d(E,F)=3d(E, F) = 3$ が最小なので、クラスタ **EとF** を統合。
    2. **新しいクラスタ CEFC_{EF} の距離を計算**
        - 各クラスタとの距離は **最大値** をとる：
            
            $$
            d(C_{EF}, A) = max(9, 12) = 12\\
            d(C_{EF}, B) = max(7, 10) = 10\\
            d(C_{EF}, C) = max(6, 9) = 9\\
            d(C_{EF}, D) = max(5, 6) = 6
            $$
            
    3. **距離行列を更新**
        
        ```
            A   B   C   D  EF
        A   0   2   6  10  12
        B   2   0   4   8  10
        C   6   4   0   7   9
        D  10   8   7   0   6
        
        ```
        
    
    ```
    ┌──(E, F)
    │
    ├──(D, (E, F))
    │
    ├──(C, (D, (E, F)))
    │
    ├──(B, (C, (D, (E, F))))
    │
    └──(A, (B, (C, (D, (E, F)))))
    
    ```
    
- (2)
    
    ユークリッド距離：$d_m (x,y)= \sqrt{\sum_{i=1}^p |x_i - y_i|^2 }$
    
    k-means
    
    初期の中心点と各データのユークリッド距離を求める
    
    $x_1^{(0)}$
    
    | データ | 平均$\bar{x}_1^{(0)}$との差 | $(x_i - \bar{x}_1^{(0)})^T(x_i - \bar{x}_1^{(0)})$ | $\sqrt{(x_i - \bar{x}_1^{(0)})^T(x_i - \bar{x}_1^{(0)})}$ |
    | --- | --- | --- | --- |
    | 7.7, 5.8, 7.7 | -1.3, -0.2, 0.7 | 2.22 | 1.489 |
    | 10.1, 5.9, 7.3 | 1.1, -0.1, 0.3 | 1.31 | 1.144 |
    | 4.9, 4.1, 7.9 | -4.1, -1.9, 0.9 | 21.23 | 4.607 |
    | 4.8, 5.0, 9.0 | -4.2, -1.0, 2.0 | 22.64 | 4.758 |
    | 6.4, 3.7, 8.0 | -2.6, -2.3, 1.0 | 13.05 | 3.612 |
    | 4.0, 5.2, 11.6 | -5.0, -0.8, 4.6 | 46.8 | 6.841 |
    
    $x_2^{(0)}$
    
    5,5,10
    
    | データ | 平均$\bar{x}_1^{(0)}$との差 | $(x_i - \bar{x}_1^{(0)})^T(x_i - \bar{x}_1^{(0)})$ | $\sqrt{(x_i - \bar{x}_1^{(0)})^T(x_i - \bar{x}_1^{(0)})}$ |
    | --- | --- | --- | --- |
    | 7.7, 5.8, 7.7 | -2.7, 0.8, -2.3 | 13.22 | 3.635 |
    | 10.1, 5.9, 7.3 | 5.1, 0.9, -2.7 | 34.11 | 5.84 |
    | 4.9, 4.1, 7.9 | -0.1, -0.9, -2.1 | 5.23 | 2.28 |
    | 4.8, 5.0, 9.0 | -0.2, 0, -1 | 1.04 | 1.019 |
    | 6.4, 3.7, 8.0 | 1.4, -1.3, -2 | 7.65 | 2.76 |
    | 4.0, 5.2, 11.6 | -1, 0.2, 1.6 | 3.6 | 1.897 |
    
    上記より
    
    | ユーザー | クラスター |
    | --- | --- |
    | 1 | 1 |
    | 2 | 1 |
    | 3 | 2 |
    | 4 | 2 |
    | 5 | 2 |
    | 6 | 2 |