## 統計検定準1級(Statistical Test Pre-1st grade)
## 19章 例題3
### 回答

生存関数：特定の時間までにイベント（例えば、機械の故障や患者の死亡）が発生しない確率

$S(t;x)$

基準ハザード関数：全共変量が0のとき、続く$t$時点以降でイベントが起こる瞬間的な確率

$h_0(t)$ 

基準累積ハザード関数：基準ハザード関数を積分したもの

$H_0 (t) = \int^{t}_{0} h_0(u) du$

比例ハザードモデル：

$h(t | x) = h_0(t)\cdot  exp({x^T \beta})\ \ (h_0(t) > 0)$

比例ハザードモデルの両辺を積分

$$
\int^t_0 h(t) dt =  exp({x^T \beta}) \int^t_0 h_0(t)\cdot dt
$$

問題文の $H_0(t) = \int^t_0 h_0(u)\ du$ より

$$
\int^t_0 h(t) dt =  exp({x^T \beta}) H_0 (t)
$$

左辺を計算する

$$
\int^t_0 h(t) dt = \int^t_0 - \frac{S'(t)}{S(t)} dt\\
= [-log S(t)]^t_0\\
= -log S(t) -(- log S(0))\\
$$

生存関数の公式：$\frac{d}{du} \left[ -\log S(t) \right] = -\frac{S'(t)}{S(t)}$ 

$t=0$ のときは必ず生きているので、 $S(0)=1$

よって $-log S(t)$ 

元の式の対数を取ると

$$
log(-log S(t)) = log\big(exp({x^T \beta}) H_0 (t)  \big)\\
= x^T \beta\ log\ H_0 (t)
$$

問題文の式が得られた

※比例ハザードモデル：
1. **比例ハザードモデル**
    
    $h(t | x) = h_0(t)\cdot  exp({x^T \beta})\ \ (h_0(t) > 0)$
    
    - $h(t \mid x)$：時点$t$における共変量$x$による条件付きハザード関数
    - $\exp(\beta^T X)$ 共変量 $x$の影響を指数関数的に示す部分
2. **比例ハザード仮定**:
異なる共変量レベル間でのハザード比が時間に依存せず一定
    
    具体的に言えば、2つの異なる個体間のハザード比（リスクの比）は、観察期間中に一貫して比例する
    
3. **半パラメトリックモデル**:
ベースラインハザード関数 $h_0(t)$ の特定の形状を指定しない